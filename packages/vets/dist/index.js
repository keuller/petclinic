var i=Symbol.for("drizzle:entityKind"),Xs=Symbol.for("drizzle:hasOwnEntityKind");function c(s,e){if(!s||typeof s!="object")return!1;if(s instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,i))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=s.constructor;if(t)for(;t;){if(i in t&&t[i]===e[i])return!0;t=Object.getPrototypeOf(t)}return!1}var C=class{table;static[i]="Column";name;primary;notNull;default;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.notNull=t.notNull,this.default=t.default,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}},fe=Symbol.for("drizzle:Name"),Be=Symbol.for("drizzle:Schema"),dt=Symbol.for("drizzle:Columns"),Qe=Symbol.for("drizzle:OriginalName"),ve=Symbol.for("drizzle:BaseName"),mt=Symbol.for("drizzle:IsAlias"),ht=Symbol.for("drizzle:ExtraConfigBuilder"),Zs=Symbol.for("drizzle:IsDrizzleTable"),d=class{static[i]="Table";static Symbol={Name:fe,Schema:Be,OriginalName:Qe,Columns:dt,BaseName:ve,IsAlias:mt,ExtraConfigBuilder:ht};[fe];[Qe];[Be];[dt];[ve];[mt]=!1;[ht]=void 0;[Zs]=!0;constructor(e,t,n){this[fe]=this[Qe]=e,this[Be]=t,this[ve]=n}getSQL(){return new m([this])}};function ce(s){return s[fe]}var pt=class{name;value;static[i]="PgCheckBuilder";brand;constructor(e,t){this.name=e,this.value=t}build(e){return new Ae(e,this)}},Ae=class{table;static[i]="PgCheck";name;value;constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}};var Ve=Symbol.for("drizzle:PgInlineForeignKeys"),A=class extends d{static[i]="PgTable";static Symbol=Object.assign({},d.Symbol,{InlineForeignKeys:Ve});[Ve]=[];[d.Symbol.ExtraConfigBuilder]=void 0};function Qt(s,e,t,n,r=s){let o=new A(s,n,r),l=Object.fromEntries(Object.entries(e).map(([h,f])=>{let p=f.build(o);return o[Ve].push(...f.buildForeignKeys(p,o)),[h,p]})),u=Object.assign(o,l);return u[d.Symbol.Columns]=l,t&&(u[A.Symbol.ExtraConfigBuilder]=t),u}var G=(s,e,t)=>Qt(s,e,t,void 0);var $=Symbol.for("drizzle:ViewBaseConfig"),E=class{static[i]="View";[$];constructor({name:e,schema:t,selectedFields:n,query:r}){this[$]={name:e,originalName:e,schema:t,selectedFields:n,query:r,isExisting:!r,isAlias:!1}}getSQL(){return new m([this])}},Le=class{static[i]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{columns:n,foreignColumns:r}=e();return{columns:n,foreignTable:r[0].table,foreignColumns:r}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Ie(e,this)}},Ie=class{table;static[i]="PgForeignKey";reference;onUpdate;onDelete;constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}getName(){let{columns:e,foreignColumns:t}=this.reference(),n=e.map(l=>l.name),r=t.map(l=>l.name);return`${[this.table[A.Symbol.Name],...n,t[0].table[A.Symbol.Name],...r].join("_")}_fk`}};var gt=class{unique;name;static[i]="PgIndexBuilderOn";constructor(e,t){this.unique=e,this.name=t}on(...e){return new me(e,this.unique,!1,this.name)}onOnly(...e){return new me(e,this.unique,!0,this.name)}},me=class{static[i]="PgIndexBuilder";config;constructor(e,t,n,r){this.config={name:r,columns:e,unique:t,only:n}}concurrently(){return this.config.concurrently=!0,this}using(e){return this.config.using=e,this}asc(){return this.config.order="asc",this}desc(){return this.config.order="desc",this}nullsFirst(){return this.config.nulls="first",this}nullsLast(){return this.config.nulls="last",this}where(e){return this.config.where=e,this}build(e){return new Fe(this.config,e)}},Fe=class{static[i]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}};function vt(...s){return new Ee(s)}var Ee=class{static[i]="PgPrimaryKeyBuilder";columns;constructor(e){this.columns=e}build(e){return new Ke(e,this.columns)}},Ke=class{table;static[i]="PgPrimaryKey";columns;constructor(e,t){this.table=e,this.columns=t}getName(){return`${this.table[A.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};function At(s,e){return`${s[A.Symbol.Name]}_${e.join("_")}_unique`}var Me=class{name;static[i]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;constructor(e,t){this.name=t,this.columns=e}nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Re(e,this.columns,this.nullsNotDistinctConfig,this.name)}},bt=class{static[i]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new Me(e,this.name)}},Re=class{table;static[i]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;constructor(e,t,n,r){this.table=e,this.columns=t,this.name=r??At(this.table,this.columns.map(o=>o.name)),this.nullsNotDistinct=n}getName(){return this.name}},z=Symbol.for("drizzle:SubqueryConfig"),L=class{static[i]="Subquery";[z];constructor(e,t,n,r=!1){this[z]={sql:e,selection:t,alias:n,isWith:r}}getSQL(){return new m([this])}},Ue=class extends L{static[i]="WithSubquery"},j=class s{static[i]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t===z)return{...e[z],selection:new Proxy(e[z].selection,this)};if(t===$)return{...e[$],selectedFields:new Proxy(e[$].selectedFields,this)};if(typeof t=="symbol")return e[t];let r=(c(e,L)?e[z].selection:c(e,E)?e[$].selectedFields:e)[t];if(c(r,m.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!r.isSelectionField)return r.sql;let o=r.clone();return o.isSelectionField=!0,o}if(c(r,m)){if(this.config.sqlBehavior==="sql")return r;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return c(r,C)?this.config.alias?new Proxy(r,new H(new Proxy(r.table,new Y(this.config.alias,this.config.replaceOriginalName??!1)))):r:typeof r!="object"||r===null?r:new Proxy(r,new s(this.config))}};function he(s,e){return Object.entries(s).reduce((t,[n,r])=>{if(typeof n!="string")return t;let o=e?[...e,n]:[n];return c(r,C)||c(r,m)||c(r,m.Aliased)?t.push({path:o,field:r}):c(r,d)?t.push(...he(r[d.Symbol.Columns],o)):t.push(...he(r,o)),t},[])}function bs(s,e){for(let t of e)for(let n of Object.getOwnPropertyNames(t.prototype))Object.defineProperty(s.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}function lt(s){return s[d.Symbol.Columns]}function yt(s){return c(s,L)?s[z].alias:c(s,E)?s[$].name:c(s,m)?void 0:s[d.Symbol.IsAlias]?s[d.Symbol.Name]:s[d.Symbol.BaseName]}function ys(s,...e){return s(...e)}var _e=class{static[i]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}},wt={startActiveSpan(s,e){return e()}},pe=class s extends Error{static[i]="DrizzleError";constructor(e){super(e),this.name="DrizzleError"}static wrap(e,t){return e instanceof Error?new s(t?`${t}: ${e.message}`:e.message):new s(t??String(e))}},St=class extends pe{static[i]="TransactionRollbackError";constructor(){super("Rollback")}},Je=class{static[i]="PgDialect";async migrate(e,t){let n=a`
			CREATE TABLE IF NOT EXISTS "drizzle"."__drizzle_migrations" (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(a`CREATE SCHEMA IF NOT EXISTS "drizzle"`),await t.execute(n);let o=(await t.all(a`select id, hash, created_at from "drizzle"."__drizzle_migrations" order by created_at desc limit 1`))[0];await t.transaction(async l=>{for await(let u of e)if(!o||Number(o.created_at)<u.folderMillis){for(let h of u.sql)await l.execute(a.raw(h));await l.execute(a`insert into "drizzle"."__drizzle_migrations" ("hash", "created_at") values(${u.hash}, ${u.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildDeleteQuery({table:e,where:t,returning:n}){let r=n?a` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=t?a` where ${t}`:void 0;return a`delete from ${e}${o}${r}`}buildUpdateSet(e,t){let n=Object.entries(t),r=n.length;return a.join(n.flatMap(([o,l],u)=>{let h=e[d.Symbol.Columns][o],f=a`${a.identifier(h.name)} = ${l}`;return u<r-1?[f,a.raw(", ")]:[f]}))}buildUpdateQuery({table:e,set:t,where:n,returning:r}){let o=this.buildUpdateSet(e,t),l=r?a` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,u=n?a` where ${n}`:void 0;return a`update ${e} set ${o}${u}${l}`}buildSelection(e,{isSingleTable:t=!1}={}){let n=e.length,r=e.flatMap(({field:o},l)=>{let u=[];if(c(o,m.Aliased)&&o.isSelectionField)u.push(a.identifier(o.fieldAlias));else if(c(o,m.Aliased)||c(o,m)){let h=c(o,m.Aliased)?o.sql:o;t?u.push(new m(h.queryChunks.map(f=>c(f,g)?a.identifier(f.name):f))):u.push(h),c(o,m.Aliased)&&u.push(a` as ${a.identifier(o.fieldAlias)}`)}else c(o,C)&&(t?u.push(a.identifier(o.name)):u.push(o));return l<n-1&&u.push(a`, `),u});return a.join(r)}buildSelectQuery({withList:e,fields:t,fieldsFlat:n,where:r,having:o,table:l,joins:u,orderBy:h,groupBy:f,limit:p,offset:T,lockingClauses:O,distinct:Q}){let v=n??he(t);for(let S of v)if(c(S.field,C)&&ce(S.field.table)!==(c(l,L)?l[z].alias:c(l,J)?l[$].name:c(l,m)?void 0:ce(l))&&!(N=>u?.some(({alias:P})=>P===(N[d.Symbol.IsAlias]?ce(N):N[d.Symbol.BaseName])))(S.field.table)){let N=ce(S.field.table);throw new Error(`Your "${S.path.join("->")}" field references a column "${N}"."${S.field.name}", but the table "${N}" is not part of the query! Did you forget to join it?`)}let U=!u||u.length===0,D;if(e?.length){let S=[a`with `];for(let[N,P]of e.entries())S.push(a`${a.identifier(P[z].alias)} as (${P[z].sql})`),N<e.length-1&&S.push(a`, `);S.push(a` `),D=a.join(S)}let B;Q&&(B=Q===!0?a` distinct`:a` distinct on (${a.join(Q.on,", ")})`);let K=this.buildSelection(v,{isSingleTable:U}),V=(()=>{if(c(l,d)&&l[d.Symbol.OriginalName]!==l[d.Symbol.Name]){let S=a`${a.identifier(l[d.Symbol.OriginalName])}`;return l[d.Symbol.Schema]&&(S=a`${a.identifier(l[d.Symbol.Schema])}.${S}`),a`${S} ${a.identifier(l[d.Symbol.Name])}`}return l})(),q=[];if(u)for(let[S,N]of u.entries()){S===0&&q.push(a` `);let P=N.table,ae=N.lateral?a` lateral`:void 0;if(c(P,A)){let oe=P[A.Symbol.Name],_=P[A.Symbol.Schema],le=P[A.Symbol.OriginalName],ue=oe===le?void 0:N.alias;q.push(a`${a.raw(N.joinType)} join${ae} ${_?a`${a.identifier(_)}.`:void 0}${a.identifier(le)}${ue&&a` ${a.identifier(ue)}`} on ${N.on}`)}else if(c(P,E)){let oe=P[$].name,_=P[$].schema,le=P[$].originalName,ue=oe===le?void 0:N.alias;q.push(a`${a.raw(N.joinType)} join${ae} ${_?a`${a.identifier(_)}.`:void 0}${a.identifier(le)}${ue&&a` ${a.identifier(ue)}`} on ${N.on}`)}else q.push(a`${a.raw(N.joinType)} join${ae} ${P} on ${N.on}`);S<u.length-1&&q.push(a` `)}let X=a.join(q),R=r?a` where ${r}`:void 0,b=o?a` having ${o}`:void 0,w;h&&h.length>0&&(w=a` order by ${a.join(h,a`, `)}`);let I;f&&f.length>0&&(I=a` group by ${a.join(f,a`, `)}`);let Oe=p?a` limit ${p}`:void 0,ft=T?a` offset ${T}`:void 0,Z=a.empty();if(O)for(let{strength:S,config:N}of O){let P=a` for ${a.raw(S)}`;N.of&&P.append(a` of ${N.of}`),N.noWait?P.append(a` no wait`):N.skipLocked&&P.append(a` skip locked`),Z.append(P)}return a`${D}select${B} ${K} from ${V}${X}${R}${I}${b}${w}${Oe}${ft}${Z}`}buildInsertQuery({table:e,values:t,onConflict:n,returning:r}){let o=[],l=e[d.Symbol.Columns],u=Object.entries(l),h=u.map(([,O])=>a.identifier(O.name));for(let[O,Q]of t.entries()){let v=[];for(let[U]of u){let D=Q[U];D===void 0||c(D,k)&&D.value===void 0?v.push(a`default`):v.push(D)}o.push(v),O<t.length-1&&o.push(a`, `)}let f=a.join(o),p=r?a` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,T=n?a` on conflict ${n}`:void 0;return a`insert into ${e} ${h} values ${f}${T}${p}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:n}){let r=t?a` concurrently`:void 0,o=n?a` with no data`:void 0;return a`refresh materialized view${r} ${e}${o}`}prepareTyping(e){return c(e,Te)||c(e,Ne)?"json":c(e,Pe)?"decimal":c(e,xe)?"time":c(e,$e)?"timestamp":c(e,Se)?"date":c(e,qe)?"uuid":"none"}sqlToQuery(e){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:r,tableConfig:o,queryConfig:l,tableAlias:u,nestedQueryRelation:h,joinOn:f}){let p=[],T,O,Q=[],v,U=[];if(l===!0)p=Object.entries(o.columns).map(([K,V])=>({dbKey:V.name,tsKey:K,field:F(V,u),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let B=Object.fromEntries(Object.entries(o.columns).map(([b,w])=>[b,F(w,u)]));if(l.where){let b=typeof l.where=="function"?l.where(B,Ts()):l.where;v=b&&ze(b,u)}let K=[],V=[];if(l.columns){let b=!1;for(let[w,I]of Object.entries(l.columns))I!==void 0&&w in o.columns&&(!b&&I===!0&&(b=!0),V.push(w));V.length>0&&(V=b?V.filter(w=>l.columns?.[w]===!0):Object.keys(o.columns).filter(w=>!V.includes(w)))}else V=Object.keys(o.columns);for(let b of V){let w=o.columns[b];K.push({tsKey:b,value:w})}let q=[];l.with&&(q=Object.entries(l.with).filter(b=>!!b[1]).map(([b,w])=>({tsKey:b,queryConfig:w,relation:o.relations[b]})));let X;if(l.extras){X=typeof l.extras=="function"?l.extras(B,{sql:a}):l.extras;for(let[b,w]of Object.entries(X))K.push({tsKey:b,value:Rt(w,u)})}for(let{tsKey:b,value:w}of K)p.push({dbKey:c(w,m.Aliased)?w.fieldAlias:o.columns[b].name,tsKey:b,field:c(w,C)?F(w,u):w,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof l.orderBy=="function"?l.orderBy(B,Ps()):l.orderBy??[];Array.isArray(R)||(R=[R]),Q=R.map(b=>c(b,C)?F(b,u):ze(b,u)),T=l.limit,O=l.offset;for(let{tsKey:b,queryConfig:w,relation:I}of q){let Oe=xs(t,n,I),ft=I.referencedTable[d.Symbol.Name],Z=n[ft],S=`${u}_${b}`,N=ot(...Oe.fields.map((oe,_)=>Ft(F(Oe.references[_],S),F(oe,u)))),P=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:e[Z],tableConfig:t[Z],queryConfig:c(I,ne)?w===!0?{limit:1}:{...w,limit:1}:w,tableAlias:S,joinOn:N,nestedQueryRelation:I}),ae=a`${a.identifier(S)}.${a.identifier("data")}`.as(b);U.push({on:a`true`,table:new L(P.sql,{},S),alias:S,joinType:"left",lateral:!0}),p.push({dbKey:b,tsKey:b,field:ae,relationTableTsKey:Z,isJson:!0,selection:P.selection})}}if(p.length===0)throw new pe(`No fields selected for table "${o.tsName}" ("${u}")`);let D;if(v=ot(f,v),h){let B=a`json_build_array(${a.join(p.map(({field:q,tsKey:X,isJson:R})=>R?a`${a.identifier(`${u}_${X}`)}.${a.identifier("data")}`:c(q,m.Aliased)?q.sql:q),a`, `)})`;c(h,at)&&(B=a`coalesce(json_agg(${B}${Q.length>0?a` order by ${a.join(Q,a`, `)}`:void 0}), '[]'::json)`);let K=[{dbKey:"data",tsKey:"data",field:B.as("data"),isJson:!0,relationTableTsKey:o.tsName,selection:p}];T!==void 0||O!==void 0||Q.length>0?(D=this.buildSelectQuery({table:de(r,u),fields:{},fieldsFlat:[{path:[],field:a.raw("*")}],where:v,limit:T,offset:O,orderBy:Q}),v=void 0,T=void 0,O=void 0,Q=[]):D=de(r,u),D=this.buildSelectQuery({table:c(D,A)?D:new L(D,{},u),fields:{},fieldsFlat:K.map(({field:q})=>({path:[],field:c(q,C)?F(q,u):q})),joins:U,where:v,limit:T,offset:O,orderBy:Q})}else D=this.buildSelectQuery({table:de(r,u),fields:{},fieldsFlat:p.map(({field:B})=>({path:[],field:c(B,C)?F(B,u):B})),joins:U,where:v,limit:T,offset:O,orderBy:Q});return{tableTsKey:o.tsName,sql:D,selection:p}}},Nt=class{static[i]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}},M=class{static[i]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let t=!!this.fields,n;return this.fields?n=this.fields:c(e,L)?n=Object.fromEntries(Object.keys(e[z].selection).map(r=>[r,e[r]])):c(e,J)?n=e[$].selectedFields:c(e,m)?n={}:n=lt(e),new ge({table:e,fields:n,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}},We=class extends Nt{static[i]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:n,session:r,dialect:o,withList:l,distinct:u}){super(),this.config={withList:l,table:e,fields:{...t},distinct:u},this.isPartialSelect=n,this.session=r,this.dialect=o,this._={selectedFields:t},this.tableName=yt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(t,n)=>{let r=this.tableName,o=yt(t);if(typeof o=="string"&&this.config.joins?.some(l=>l.alias===o))throw new Error(`Alias "${o}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof r=="string"&&(this.config.fields={[r]:this.config.fields}),typeof o=="string"&&!c(t,m))){let l=c(t,L)?t[z].selection:c(t,E)?t[$].selectedFields:t[d.Symbol.Columns];this.config.fields[o]=l}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new j({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:t,joinType:e,alias:o}),typeof o=="string")switch(e){case"left":{this.joinsNotNullableMap[o]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([l])=>[l,!1])),this.joinsNotNullableMap[o]=!0;break}case"inner":{this.joinsNotNullableMap[o]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([l])=>[l,!1])),this.joinsNotNullableMap[o]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new j({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new j({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new j({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new j({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.orderBy=Array.isArray(t)?t:[t]}else this.config.orderBy=e;return this}limit(e){return this.config.limit=e,this}offset(e){return this.config.offset=e,this}for(e,t={}){return this.config.lockingClauses||(this.config.lockingClauses=[]),this.config.lockingClauses.push({strength:e,config:t}),this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new L(this.getSQL(),this.config.fields,e),new j({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}},ge=class extends We{static[i]="PgSelect";_prepare(e){let{session:t,config:n,dialect:r,joinsNotNullableMap:o}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return wt.startActiveSpan("drizzle.prepareQuery",()=>{let l=he(n.fields),u=t.prepareQuery(r.sqlToQuery(this.getSQL()),l,e);return u.joinsNotNullableMap=o,u})}prepare(e){return this._prepare(e)}execute=e=>wt.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))};bs(ge,[_e]);var be=class{static[i]="PgQueryBuilder";dialect;$with(e){let t=this;return{as(n){return typeof n=="function"&&(n=n(t)),new Proxy(new Ue(n.getSQL(),n.getSelectedFields(),e,!0),new j({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...e){let t=this;function n(l){return new M({fields:l??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function r(l){return new M({fields:l??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function o(l,u){return new M({fields:u??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:l}})}return{select:n,selectDistinct:r,selectDistinctOn:o}}select(e){return new M({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new M({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new M({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Je),this.dialect}},ye=class{name;schema;static[i]="PgDefaultViewBuilderCore";constructor(e,t){this.name=e,this.schema=t}config={};with(e){return this.config.with=e,this}},ke=class extends ye{static[i]="PgViewBuilder";as(e){typeof e=="function"&&(e=e(new be));let t=new j({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),n=new Proxy(e.getSelectedFields(),t);return new Proxy(new ee({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:n,query:e.getSQL().inlineParams()}}),t)}},He=class extends ye{static[i]="PgManualViewBuilder";columns;constructor(e,t,n){super(e,n),this.columns=lt(G(e,t))}existing(){return new Proxy(new ee({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new j({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new ee({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new j({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}},we=class{name;schema;static[i]="PgMaterializedViewBuilderCore";constructor(e,t){this.name=e,this.schema=t}config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}},Ye=class extends we{static[i]="PgMaterializedViewBuilder";as(e){typeof e=="function"&&(e=e(new be));let t=new j({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),n=new Proxy(e.getSelectedFields(),t);return new Proxy(new te({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:n,query:e.getSQL().inlineParams()}}),t)}},Ge=class extends we{static[i]="PgManualMaterializedViewBuilder";columns;constructor(e,t,n){super(e,n),this.columns=lt(G(e,t))}existing(){return new Proxy(new te({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new j({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new te({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new j({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}},J=class extends E{static[i]="PgViewBase"},Tt=Symbol.for("drizzle:PgViewConfig"),ee=class extends J{static[i]="PgView";[Tt];constructor({pgConfig:e,config:t}){super(t),e&&(this[Tt]={with:e.with})}},Pt=Symbol.for("drizzle:PgMaterializedViewConfig"),te=class extends J{static[i]="PgMaterializedView";[Pt];constructor({pgConfig:e,config:t}){super(t),this[Pt]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}};function ws(s,e,t){return e?new He(s,e,t):new ke(s,t)}function Ss(s,e,t){return e?new Ge(s,e,t):new Ye(s,t)}function gs(s,e,t){for(let n=e;n<s.length;n++){let r=s[n];if(r==="\\"){n++;continue}if(r==='"')return[s.slice(e,n).replace(/\\/g,""),n+1];if(!t&&(r===","||r==="}"))return[s.slice(e,n).replace(/\\/g,""),n]}return[s.slice(e).replace(/\\/g,""),s.length]}function Vt(s,e=0){let t=[],n=e,r=!1;for(;n<s.length;){let o=s[n];if(o===","){(r||n===e)&&t.push(""),r=!0,n++;continue}if(r=!1,o==="\\"){n+=2;continue}if(o==='"'){let[h,f]=gs(s,n+1,!0);t.push(h),n=f;continue}if(o==="}")return[t,n+1];if(o==="{"){let[h,f]=Vt(s,n+1);t.push(h),n=f;continue}let[l,u]=gs(s,n,!1);t.push(l),n=u}return[t,n]}function Ns(s){let[e]=Vt(s,1);return e}function Lt(s){return`{${s.map(e=>Array.isArray(e)?Lt(e):typeof e=="string"&&e.includes(",")?`"${e.replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Xe=class{static[i]="ColumnBuilder";config;constructor(e,t,n){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:n}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}},y=class extends Xe{foreignKeyConfigs=[];static[i]="PgColumnBuilder";array(e){return new Ze(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:n,actions:r})=>ys((o,l)=>{let u=new Le(()=>{let h=o();return{columns:[e],foreignColumns:[h]}});return l.onUpdate&&u.onUpdate(l.onUpdate),l.onDelete&&u.onDelete(l.onDelete),u.build(t)},n,r))}},g=class extends C{table;static[i]="PgColumn";constructor(e,t){t.uniqueName||(t.uniqueName=At(e,[t.name])),super(e,t),this.table=e}},Ze=class extends y{static[i]="PgArrayBuilder";constructor(e,t,n){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=n}build(e){let t=this.config.baseBuilder.build(e);return new et(e,this.config,t)}},et=class s extends g{baseColumn;range;size;static[i]="PgArray";constructor(e,t,n,r){super(e,t),this.baseColumn=n,this.range=r,this.size=t.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=Ns(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let n=e.map(r=>r===null?null:c(this.baseColumn,s)?this.baseColumn.mapToDriverValue(r,!0):this.baseColumn.mapToDriverValue(r));return t?n:Lt(n)}},W=class extends y{static[i]="PgDateColumnBaseBuilder";defaultNow(){return this.default(a`now()`)}},xt=class extends W{static[i]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Se(e,this.config)}},Se=class extends g{static[i]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},$t=class extends W{static[i]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new tt(e,this.config)}},tt=class extends g{static[i]="PgDateString";getSQLType(){return"date"}};var qt=class extends y{static[i]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Ne(e,this.config)}},Ne=class extends g{static[i]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};var Ct=class extends y{static[i]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new Te(e,this.config)}},Te=class extends g{static[i]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};var zt=class extends y{static[i]="PgNumericBuilder";constructor(e,t,n){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=n}build(e){return new Pe(e,this.config)}},Pe=class extends g{static[i]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};var Dt=class extends W{withTimezone;precision;static[i]="PgTimeBuilder";constructor(e,t,n){super(e,"string","PgTime"),this.withTimezone=t,this.precision=n,this.config.withTimezone=t,this.config.precision=n}build(e){return new xe(e,this.config)}},xe=class extends g{static[i]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};var st=class extends W{static[i]="PgTimestampBuilder";constructor(e,t,n){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=n}build(e){return new $e(e,this.config)}},$e=class extends g{static[i]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>this.withTimezone?e.toUTCString():e.toISOString()},nt=class extends W{static[i]="PgTimestampStringBuilder";constructor(e,t,n){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=n}build(e){return new it(e,this.config)}},it=class extends g{static[i]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function It(s,e={}){return e.mode==="string"?new nt(s,e.withTimezone??!1,e.precision):new st(s,e.withTimezone??!1,e.precision)}var jt=class extends y{static[i]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(a`gen_random_uuid()`)}build(e){return new qe(e,this.config)}},qe=class extends g{static[i]="PgUUID";getSQLType(){return"uuid"}};var se=class{sourceTable;referencedTable;relationName;static[i]="Relation";referencedTableName;fieldName;constructor(e,t,n){this.sourceTable=e,this.referencedTable=t,this.relationName=n,this.referencedTableName=t[d.Symbol.Name]}},rt=class{table;config;static[i]="Relations";constructor(e,t){this.table=e,this.config=t}},ne=class s extends se{config;isNullable;static[i]="One";constructor(e,t,n,r){super(e,t,n?.relationName),this.config=n,this.isNullable=r}withFieldName(e){let t=new s(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},at=class s extends se{config;static[i]="Many";constructor(e,t,n){super(e,t,n?.relationName),this.config=n}withFieldName(e){let t=new s(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}};function Ts(){return{sql:a,eq:Ft,and:ot,or:qs}}function Ps(){return{sql:a,asc:Cs,desc:zs}}function De(s,e){return new rt(s,t=>Object.fromEntries(Object.entries(e(t)).map(([n,r])=>[n,r.withFieldName(n)])))}function xs(s,e,t){if(c(t,ne)&&t.config)return{fields:t.config.fields,references:t.config.references};let n=e[t.referencedTable[d.Symbol.Name]];if(!n)throw new Error(`Table "${t.referencedTable[d.Symbol.Name]}" not found in schema`);let r=s[n];if(!r)throw new Error(`Table "${n}" not found in schema`);let o=t.sourceTable,l=e[o[d.Symbol.Name]];if(!l)throw new Error(`Table "${o[d.Symbol.Name]}" not found in schema`);let u=[];for(let h of Object.values(r.relations))(t.relationName&&t!==h&&h.relationName===t.relationName||!t.relationName&&h.referencedTable===t.sourceTable)&&u.push(h);if(u.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${t.sourceTable[d.Symbol.Name]}". Please specify relation name`);if(u[0]&&c(u[0],ne)&&u[0].config)return{fields:u[0].config.references,references:u[0].config.fields};throw new Error(`There is not enough information to infer relation "${l}.${t.fieldName}"`)}function $s(s,e){return Ds(e)&&!Et(s)&&!c(s,k)&&!c(s,Ce)&&!c(s,C)&&!c(s,d)&&!c(s,E)?new k(s,e):s}var Ft=(s,e)=>a`${s} = ${$s(e,s)}`;function ot(...s){let e=s.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new m(e):new m([new x("("),a.join(e,new x(" and ")),new x(")")])}function qs(...s){let e=s.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new m(e):new m([new x("("),a.join(e,new x(" or ")),new x(")")])}function Cs(s){return a`${s} asc`}function zs(s){return a`${s} desc`}var Ot=class{static[i]="FakePrimitiveParam"};function Et(s){return typeof s=="object"&&s!==null&&"getSQL"in s&&typeof s.getSQL=="function"}function en(s){let e={sql:"",params:[]};for(let t of s)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings=e.typings||[],e.typings.push(...t.typings));return e}var x=class{static[i]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new m([this])}},m=class s{queryChunks;static[i]="SQL";decoder=Kt;shouldInlineParams=!1;constructor(e){this.queryChunks=e}append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return wt.startActiveSpan("drizzle.buildSQL",t=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,t){let n=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{escapeName:r,escapeParam:o,prepareTyping:l,inlineParams:u,paramStartIndex:h}=n;return en(e.map(f=>{if(c(f,x))return{sql:f.value.join(""),params:[]};if(c(f,ie))return{sql:r(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let p=[new x("(")];for(let[T,O]of f.entries())p.push(O),T<f.length-1&&p.push(new x(", "));return p.push(new x(")")),this.buildQueryFromSourceParams(p,n)}if(c(f,s))return this.buildQueryFromSourceParams(f.queryChunks,{...n,inlineParams:u||f.shouldInlineParams});if(c(f,d)){let p=f[d.Symbol.Schema],T=f[d.Symbol.Name];return{sql:p===void 0?r(T):r(p)+"."+r(T),params:[]}}if(c(f,C))return{sql:r(f.table[d.Symbol.Name])+"."+r(f.name),params:[]};if(c(f,E)){let p=f[$].schema,T=f[$].name;return{sql:p===void 0?r(T):r(p)+"."+r(T),params:[]}}if(c(f,k)){let p=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(c(p,s))return this.buildQueryFromSourceParams([p],n);if(u)return{sql:this.mapInlineParam(p,n),params:[]};let T;return l!==void 0&&(T=[l(f.encoder)]),{sql:o(h.value++,p),params:[p],typings:T}}return c(f,Ce)?{sql:o(h.value++,f),params:[f]}:c(f,s.Aliased)&&f.fieldAlias!==void 0?{sql:r(f.fieldAlias),params:[]}:c(f,L)?f[z].isWith?{sql:r(f[z].alias),params:[]}:this.buildQueryFromSourceParams([new x("("),f[z].sql,new x(") "),new ie(f[z].alias)],n):Et(f)?this.buildQueryFromSourceParams([new x("("),f.getSQL(),new x(")")],n):c(f,se)?this.buildQueryFromSourceParams([f.sourceTable,new x("."),a.identifier(f.fieldName)],n):u?{sql:this.mapInlineParam(f,n),params:[]}:{sql:o(h.value++,f),params:[f]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let n=e.toString();return t(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new s.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}},ie=class{value;static[i]="Name";brand;constructor(e){this.value=e}getSQL(){return new m([this])}};function Ds(s){return typeof s=="object"&&s!==null&&"mapToDriverValue"in s&&typeof s.mapToDriverValue=="function"}var Kt={mapFromDriverValue:s=>s},Mt={mapToDriverValue:s=>s},tn={...Kt,...Mt},k=class{value;encoder;static[i]="Param";brand;constructor(e,t=Mt){this.value=e,this.encoder=t}getSQL(){return new m([this])}};function a(s,...e){let t=[];(e.length>0||s.length>0&&s[0]!=="")&&t.push(new x(s[0]));for(let[n,r]of e.entries())t.push(r,new x(s[n+1]));return new m(t)}(function(s){function e(){return new m([])}s.empty=e;function t(l){return new m(l)}s.fromList=t;function n(l){return new m([new x(l)])}s.raw=n;function r(l,u){let h=[];for(let[f,p]of l.entries())f>0&&u!==void 0&&h.push(u),h.push(p);return new m(h)}s.join=r;function o(l){return new ie(l)}s.identifier=o})(a||(a={}));(function(s){class e{sql;fieldAlias;static[i]="SQL.Aliased";isSelectionField=!1;constructor(n,r){this.sql=n,this.fieldAlias=r}getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}s.Aliased=e})(m||(m={}));var Ce=class{name;static[i]="Placeholder";constructor(e){this.name=e}getSQL(){return new m([this])}};C.prototype.getSQL=function(){return new m([this])};var H=class{table;static[i]="ColumnAliasProxyHandler";constructor(e){this.table=e}get(e,t){return t==="table"?this.table:e[t]}},Y=class{alias;replaceOriginalName;static[i]="TableAliasProxyHandler";constructor(e,t){this.alias=e,this.replaceOriginalName=t}get(e,t){if(t===d.Symbol.IsAlias)return!0;if(t===d.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===d.Symbol.OriginalName)return this.alias;if(t===$)return{...e[$],name:this.alias,isAlias:!0};if(t===d.Symbol.Columns){let r=e[d.Symbol.Columns];if(!r)return r;let o={};return Object.keys(r).map(l=>{o[l]=new Proxy(r[l],new H(new Proxy(e,this)))}),o}let n=e[t];return c(n,C)?new Proxy(n,new H(new Proxy(e,this))):n}},Bt=class{alias;static[i]="RelationTableAliasProxyHandler";constructor(e){this.alias=e}get(e,t){return t==="sourceTable"?de(e.sourceTable,this.alias):e[t]}};function de(s,e){return new Proxy(s,new Y(e,!1))}function F(s,e){return new Proxy(s,new H(new Proxy(s.table,new Y(e,!1))))}function Rt(s,e){return new m.Aliased(ze(s.sql,e),s.fieldAlias)}function ze(s,e){return a.join(s.queryChunks.map(t=>c(t,C)?F(t,e):c(t,m)?ze(t,e):c(t,m.Aliased)?Rt(t,e):t))}var js=class extends y{static[i]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Ut(e,this.config)}},Ut=class extends g{static[i]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Os=class extends y{static[i]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new _t(e,this.config)}},_t=class extends g{static[i]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}};var Bs=class extends y{static[i]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Jt(e,this.config)}},Jt=class extends g{static[i]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Qs=class extends y{static[i]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Wt(e,this.config)}},Wt=class extends g{static[i]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};var vs=class extends y{static[i]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new kt(e,this.config)}},kt=class extends g{static[i]="PgBoolean";getSQLType(){return"boolean"}};var Ht=class extends y{static[i]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Yt(e,this.config)}},Yt=class extends g{static[i]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}};function je(s,e={}){return new Ht(s,e)}var As=class extends y{static[i]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new Gt(e,this.config)}},Gt=class extends g{static[i]="PgCidr";getSQLType(){return"cidr"}};var Vs=class extends y{static[i]="PgCustomColumnBuilder";constructor(e,t,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=n}build(e){return new Xt(e,this.config)}},Xt=class extends g{static[i]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}};var Ls=class extends y{static[i]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Zt(e,this.config)}},Zt=class extends g{static[i]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};var Pn=Symbol.for("drizzle:isPgEnum");var Is=class extends y{static[i]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new es(e,this.config)}},es=class extends g{static[i]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};var Fs=class extends y{static[i]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new ts(e,this.config)}},ts=class extends g{static[i]="PgInet";getSQLType(){return"inet"}};var Es=class extends y{static[i]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new ss(e,this.config)}},ss=class extends g{static[i]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};var Ks=class extends y{static[i]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new ns(e,this.config)}},ns=class extends g{static[i]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}};var Ms=class extends y{static[i]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new is(e,this.config)}},is=class extends g{static[i]="PgMacaddr";getSQLType(){return"macaddr"}};var Rs=class extends y{static[i]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new rs(e,this.config)}},rs=class extends g{static[i]="PgMacaddr8";getSQLType(){return"macaddr8"}};var Us=class extends y{static[i]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new as(e,this.config)}},as=class extends g{static[i]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};var _s=class extends y{static[i]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new os(e,this.config)}},os=class extends g{static[i]="PgSerial";getSQLType(){return"serial"}};var Js=class extends y{static[i]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new ls(e,this.config)}},ls=class extends g{static[i]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e};var Ws=class extends y{static[i]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new us(e,this.config)}},us=class extends g{static[i]="PgSmallSerial";getSQLType(){return"serial"}};var ks=class extends y{static[i]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new cs(e,this.config)}},cs=class extends g{static[i]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}};var fs=class extends y{static[i]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new ds(e,this.config)}},ds=class extends g{static[i]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};function re(s,e={}){return new fs(s,e)}var Hs=class{schemaName;static[i]="PgSchema";constructor(e){this.schemaName=e}table=(e,t,n)=>Qt(e,t,n,this.schemaName);view=(e,t)=>ws(e,t,this.schemaName);materializedView=(e,t)=>Ss(e,t,this.schemaName)};var ms=class{static[i]="ConsoleLogWriter";write(e){console.log(e)}},Ys=class{static[i]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new ms}logQuery(e,t){let n=t.map(o=>{try{return JSON.stringify(o)}catch{return String(o)}}),r=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${r}`)}},Gs=class{static[i]="NoopLogger";logQuery(){}};var ut=G("especialidades",{id:je("id",{length:10}).primaryKey(),nome:re("nome",{length:30}).notNull()}),li=De(ut,({many:s})=>({veterinarios:s(ct)})),ct=G("veterinarios",{id:je("id",{length:10}).primaryKey(),nome:re("nome",{length:50}).notNull(),email:re("email",{length:100}).notNull(),endereco:re("endereco",{length:100}).notNull(),cidade:re("cidade",{length:30}),createdAt:It("created_at").notNull().defaultNow()}),ui=De(ct,({many:s})=>({especialidades:s(ut)})),hs=G("vets_especs",{vetId:je("vet_id",{length:10}).notNull(),especId:je("espec_id",{length:10}).notNull()},s=>({pk:vt(s.vetId,s.especId)})),ci=De(hs,({one:s})=>({veterinario:s(ct,{fields:[hs.vetId],references:[ct.id]}),especialidade:s(ut,{fields:[hs.especId],references:[ut.id]})}));var ps=class{constructor(e){this.db=e}buscarVeterianrios(){return this.db.query.veterinarios.findMany({})}};export{ps as VeterinarioRepositorio,li as especialidadeRelations,ut as especialidades,ui as veterinarioRelations,ct as veterinarios,hs as vetsEspecialidades,ci as vetsEspecsRelations};
